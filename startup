dofile "bin/make.lua" -- Build an on-the-fly version of Titanium (un-minified)
dofile "build/titanium.lua" -- Run the compiled Titanium script

local terminalWidth, terminalHeight = term.getSize()
Manager = Application( 1, 1, terminalWidth, terminalHeight, {
    colour = 128,
    backgroundColour = 1,
    terminatable = true
})

Manager:addTheme( Theme.fromFile("test", "test.theme") )
Manager:importFromTML "test.tml"

Manager:getNode "exit_button".onTrigger = function( self )
    if RadioButton.getValue "rating" == "yes" then
        Manager:stop()
    end
end

Manager:getNode "yes_label".labelFor = Manager:getNode "yes_rating"
Manager:getNode "no_label".labelFor = Manager:getNode "no_rating"

local nameDisplay, selectedNameDisplay, nameInput = Manager:getNode "name_display", Manager:getNode "selected_name_display", Manager:getNode "name_input"
Manager:getNode "name_input".onTrigger = function( self, value, selectedValue )
    if value == "" then nameDisplay:removeClass "hasValue" else nameDisplay:addClass "hasValue" end

    if #value > 40 then
        nameDisplay.text = value:sub( 1, 40 )..("."):rep( math.min( #value - 40, 3 ) )
    elseif value == "" then
        nameDisplay.text = "Enter your name"
    else
        nameDisplay.text = value
    end

    if selectedValue then selectedNameDisplay.text = "Selected: "..selectedValue
    else selectedNameDisplay.text = "" end
end

nameInput.value = "Titanium text input test. Testing, testing 123"
nameInput.position = 100

nameInput:focus()

Manager:start()
